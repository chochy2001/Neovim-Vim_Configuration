" ~/.ideavimrc
" Traducción y corrección basada en feedback para macOS

" -----------------------------------------------------------------------------
" Líder y Plugins
" -----------------------------------------------------------------------------
let mapleader = " "

" Habilita la emulación integrada de IdeaVim para vim-surround
" Permite usar ys, cs, ds para añadir/cambiar/borrar pares circundantes.
" Quítalo si no usas esta funcionalidad.
set surround

" Plugins Vimscript (Opcional - Descomenta si los necesitas/instalas)
" Plug 'easymotion/vim-easymotion'
" Plug 'tpope/vim-commentary'

" -----------------------------------------------------------------------------
" Settings (Traducción de lua/settings.lua)
" -----------------------------------------------------------------------------
set number
set relativenumber
set tabstop=4
set shiftwidth=4
set expandtab
set smartindent
set termguicolors
set clipboard=unnamedplus
set scrolloff=8
set cursorline
set colorcolumn=80
set laststatus=2
set showcmd
set noshowmode

" -----------------------------------------------------------------------------
" Core Keymaps (Traducción de lua/keymaps/core.lua)
" -----------------------------------------------------------------------------
" Salir de modo inserción con jj
imap jj <Esc>

" Mostrar Estructura del Archivo (antes Tagbar)
" Prueba el atajo nativo Cmd+F12 si este no funciona.
nnoremap <leader>ot :action FileStructurePopup<CR>

" -----------------------------------------------------------------------------
" Búsqueda / Navegación (Reemplazo de Telescope)
" -----------------------------------------------------------------------------
" Buscar Archivos (Equivalente a Cmd+Shift+O) 
nnoremap <C-p> :action GotoFile<CR>
nnoremap <leader>pf :action GotoFile<CR>

" Buscar en Archivos (Equivalente a Cmd+Shift+F)
nnoremap <leader>pg :action FindInPath<CR>

" Activar/Enfocar ventana de Proyecto (antes file_browser)
nnoremap <leader>fb :action ActivateProjectToolWindow<CR>

" Harpoon sustituido por Marcas/Bookmarks (Funcionando según tu feedback)
nnoremap <leader>1 '1
nnoremap <leader>2 '2
nnoremap <leader>3 '3
nnoremap <leader>4 '4
nnoremap <leader>5 '5
nnoremap <leader>6 '6
nnoremap <leader>7 '7
nnoremap <leader>8 '8
nnoremap <leader>9 '9

" -----------------------------------------------------------------------------
" Buffers / Tabs (Funcionando según tu feedback)
" -----------------------------------------------------------------------------
nnoremap <leader>bn :action NextTab<CR>
nnoremap <leader>bp :action PreviousTab<CR>

" -----------------------------------------------------------------------------
" Terminal
" -----------------------------------------------------------------------------
" Abrir/Enfocar/Ocultar ventana de Terminal (Debería alternar)
nnoremap <leader>t :action ActivateTerminalToolWindow<CR>
" Salir del *modo* terminal (regresa al editor, no cierra la ventana)
tnoremap <Esc> <C-\><C-n>

" -----------------------------------------------------------------------------
" Git / VCS
" IMPORTANTE: Asegúrate que la integración Git funciona en el IDE
" (Menús Git, Ventana de Herramientas Git Cmd+9) antes de usar estos atajos.
" -----------------------------------------------------------------------------
" Mostrar historial de Git
nnoremap <leader>gl :action Vcs.ShowTabbedLog<CR>
" Abrir diálogo de Commit (Equivalente a Cmd+K)
nnoremap <leader>gc :action CheckinProject<CR>
" Añadir archivo actual a VCS
nnoremap <leader>ga :action Vcs.Add<CR>
" Mostrar ventana de Cambios Locales / VCS (Equivalente a Cmd+9)
nnoremap <leader>gs :action ActivateVersionControlToolWindow<CR>
" Abrir diálogo de Push (Equivalente a Cmd+Shift+K)
nnoremap <leader>gps :action Vcs.Push<CR>
" Actualizar Proyecto (Pull) (Equivalente a Cmd+T)
nnoremap <leader>gpl :action Vcs.UpdateProject<CR>
" Mostrar ventana de Cambios / VCS (antes Neogit)
nnoremap <leader>gg :action ActivateVersionControlToolWindow<CR>
" Mostrar historial de Git (antes Telescope git commits)
nnoremap <leader>gC :action Vcs.ShowTabbedLog<CR>
" Mostrar Ramas
nnoremap <leader>gb :action Vcs.Branches<CR>
" Mostrar ventana de Cambios / VCS (antes Telescope git status)
nnoremap <leader>gS :action ActivateVersionControlToolWindow<CR>

" -----------------------------------------------------------------------------
" Formateo (Traducción de lua/keymaps/json.lua y conform)
" -----------------------------------------------------------------------------
" Formatear código (Equivalente a Cmd+Option+L)
nnoremap <leader>fj :action ReformatCode<CR>
vnoremap <leader>fj :action ReformatCode<CR>

" -----------------------------------------------------------------------------
" Project Explorer / Navegación (Reemplazo de Neotree)
" -----------------------------------------------------------------------------
" Activar/Enfocar ventana de Proyecto
nnoremap <leader>pv :action ActivateProjectToolWindow<CR>
" Mostrar archivos recientes (Equivalente a Cmd+E)
nnoremap <leader>nbr :action RecentFiles<CR>
" Mostrar ventana de Cambios / VCS (antes Neotree git status)
nnoremap <leader>ng :action ActivateVersionControlToolWindow<CR>

" -----------------------------------------------------------------------------
" Historial Local (Reemplazo de Undotree)
" -----------------------------------------------------------------------------
" Mostrar Historial Local del archivo actual
nnoremap <leader>u :action LocalHistory.ShowHistory<CR>

" -----------------------------------------------------------------------------
" LSP Keymaps (Traducción de lua/lsp.lua on_attach)
" Asegúrate de que el LSP/IntelliSense del IDE esté activo para el lenguaje.
" -----------------------------------------------------------------------------
" K -> Mostrar documentación/hover (Default)
" gd -> Ir a definición (Default)
" gD -> Ir a declaración (Default)
" gi -> Ir a implementación (Default)

" Ir a definición de tipo
nnoremap go :action GotoTypeDeclaration<CR>
" Buscar usos/referencias (Equivalente a Option+F7)
nnoremap gr :action FindUsages<CR>
" Mostrar ayuda de signatura/parámetros (Equivalente a Cmd+P)
nnoremap gs :action ParameterInfo<CR>
" Renombrar símbolo (Equivalente a Shift+F6)
nnoremap <leader>rn :action RenameElement<CR>
" Mostrar acciones de código/intenciones (Equivalente a Option+Enter)
nnoremap <leader>ca :action ShowIntentionActions<CR>
" Mostrar ayuda de parámetros en modo inserción
inoremap <C-k> <Cmd>action ParameterInfo<CR>

" -----------------------------------------------------------------------------
" Mappings Generales (Traducción de lua/mappings.lua)
" -----------------------------------------------------------------------------
" Ir atrás/adelante en el historial de navegación
nnoremap <leader>b :action Back<CR>
nnoremap <leader>f :action Forward<CR>
" Alternativamente, prueba <C-o> y <C-i> directamente si funcionan mejor
" nnoremap <leader>b <C-o>
" nnoremap <leader>f <C-i>

" -----------------------------------------------------------------------------
" Otros Plugins / Funcionalidades
" -----------------------------------------------------------------------------
" Comentar/Descomentar línea o selección (Equivalente a Cmd+/)
nnoremap gcc :action CommentByLineComment<CR>
vnoremap gc :action CommentByLineComment<CR> 
" Corregido: era gcc también

" -----------------------------------------------------------------------------
" Fin de la configuración de .ideavimrc
" -----------------------------------------------------------------------------

" Guarda como ~/.ideavimrc y recarga con ':source ~/.ideavimrc' o reiniciando el IDE.
